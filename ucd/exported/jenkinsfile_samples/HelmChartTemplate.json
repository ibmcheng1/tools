{
    "securityResourceId": "164802f5-2d1c-f320-a92a-7e27d03e775b",
    "path": "componentTemplates\/164802f5-2d4c-031f-94d2-112d48a7d34c",
    "name": "HelmChartTemplate",
    "description": "",
    "ignoreQualifiers": 0,
    "componentType": "STANDARD",
    "tags": [],
    "active": true,
    "envPropDefs": [],
    "resPropDefs": [],
    "propDefs": [
        {
            "name": "jenkins.server",
            "label": "jenkins.server",
            "pattern": "",
            "type": "TEXT",
            "required": false,
            "description": "",
            "placeholder": ""
        },
        {
            "name": "jenkins.reviewed",
            "label": "jenkins.reviewed",
            "pattern": "",
            "type": "TEXT",
            "required": false,
            "description": "",
            "placeholder": ""
        }
    ],
    "properties": [
        {
            "name": "jenkins.reviewed",
            "description": "",
            "secure": false
        },
        {
            "name": "jenkins.server",
            "description": "",
            "secure": false
        }
    ],
    "processes": [
        {
            "name": "Deploy Helm Chart",
            "description": "",
            "defaultWorkingDir": "${p:resource\/work.dir}\/${p:component.name}",
            "takesVersion": true,
            "inventoryActionType": "ADD",
            "status": "Active",
            "configActionType": "ADD",
            "active": true,
            "path": "componentTemplates\/164802f5-2d4c-031f-94d2-112d48a7d34c\/processes\/1648ac94-bde7-c3c3-b3a5-460ed70242d2",
            "deleted": false,
            "propDefs": [],
            "rootActivity": {
                "edges": [
                    {
                        "to": "Get Environment Properties",
                        "from": "Replace Tokens",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Replace Tokens",
                        "from": "Download Artifacts",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Helm Init",
                        "from": "ICP Login",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Helm Custom Upgrade",
                        "from": "Get Component Version",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "d9f33966df5b6f03e8f84fef79bf0a",
                        "from": "Helm Custom Upgrade",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Use Context",
                        "from": "Get Environment Properties",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Get Component Version",
                        "from": "Check status before",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "ICP Login",
                        "from": "Use Context",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Download Artifacts",
                        "from": "Clean Working Directory",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Check status before",
                        "from": "Helm Init",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Clean Working Directory",
                        "type": "ALWAYS",
                        "value": ""
                    }
                ],
                "offsets": [
                    {
                        "name": "Helm Custom Upgrade",
                        "x": 310.0000000000001,
                        "y": 1010,
                        "h": 80,
                        "w": 280
                    },
                    {
                        "name": "Helm Init",
                        "x": -289.9999999999999,
                        "y": 830,
                        "h": 80,
                        "w": 230
                    },
                    {
                        "name": "Replace Tokens",
                        "x": -69.99999999999994,
                        "y": 420,
                        "h": 80,
                        "w": 280
                    },
                    {
                        "name": "d9f33966df5b6f03e8f84fef79bf0a",
                        "x": 750.0000000000001,
                        "y": 1005,
                        "h": 90,
                        "w": 130
                    },
                    {
                        "name": "Download Artifacts",
                        "x": -59.999999999999886,
                        "y": 280,
                        "h": 80,
                        "w": 300
                    },
                    {
                        "name": "Check status before",
                        "x": 60.000000000000114,
                        "y": 830,
                        "h": 80,
                        "w": 260
                    },
                    {
                        "name": "Get Component Version",
                        "x": 443.9361702127659,
                        "y": 833.9494680851063,
                        "h": 80,
                        "w": 460
                    },
                    {
                        "name": "Use Context",
                        "x": -119.99999999999989,
                        "y": 670,
                        "h": 80,
                        "w": 250
                    },
                    {
                        "name": "ICP Login",
                        "x": 205.00000000000006,
                        "y": 650,
                        "h": 80,
                        "w": 180
                    },
                    {
                        "name": "Clean Working Directory",
                        "x": -90,
                        "y": 140,
                        "h": 80,
                        "w": 380
                    },
                    {
                        "name": "Get Environment Properties",
                        "x": -119.99999999999989,
                        "y": 540,
                        "h": 80,
                        "w": 380
                    }
                ],
                "layoutMode": "manual",
                "type": "graph",
                "name": "ad7c2542-98f2-4f74-a9c2-e37b36e88949",
                "children": [
                    {
                        "type": "finish",
                        "name": "d9f33966df5b6f03e8f84fef79bf0a",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "pluginVersion": 65,
                        "commandName": "Delete Files and Directories",
                        "pluginName": "File Utils",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "baseDir": ".",
                            "includes": "**\/*\r\n*",
                            "excludes": "",
                            "followSymlinks": "false",
                            "caseSensitive": "true"
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Clean Working Directory",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "pluginVersion": 30,
                        "commandName": "Download Artifacts",
                        "pluginName": "UrbanCode Deploy Versioned File Storage",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "directoryOffset": "\/helm_chart",
                            "artifactSetBaseDir": "",
                            "fileIncludePatterns": "**\/*",
                            "fileExcludePatterns": "",
                            "syncMode": "true",
                            "fullVerification": "true",
                            "setFileExecuteBits": "false",
                            "verifyFileIntegrity": "false",
                            "versionId": "${p:version.id}",
                            "serverUrl": "${p:server.url}",
                            "compId": "${p:component.id}",
                            "resId": "${p:resource.id}",
                            "charset": "",
                            "label": ""
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Download Artifacts",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "pluginVersion": 65,
                        "commandName": "Replace Tokens",
                        "pluginName": "File Utils",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "includes": "**\/*",
                            "excludes": "",
                            "envPropValues": "${p:environment\/allProperties},${p:component\/allProperties},${p:resource\/allProperties},${p:environment\/allProperties}",
                            "propertyPrefix": "",
                            "explicitTokens": "",
                            "startDelimiter": "@@@",
                            "endDelimiter": "@@@",
                            "propFile": "replace_tokens.properties",
                            "dir": "",
                            "customEncoding": ""
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Replace Tokens",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "pluginVersion": 78,
                        "commandName": "Get Environment Properties",
                        "pluginName": "UrbanCode Deploy Environments",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "application": "${p:application.name}",
                            "environment": "${p:environment.name}"
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Get Environment Properties",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": true,
                        "impersonationUseSudo": false,
                        "pluginVersion": 15,
                        "commandName": "Use Context",
                        "pluginName": "Kubernetes",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "url": "",
                            "username": "",
                            "password": "crypt_v1{AES\/CBC\/PKCS5Padding|aes128keyabk8|Yis27Jb9r0nhh1FlKXimZA==|Oj0aL1VmBy8LR4pFLUvVGA==}",
                            "namespace": "",
                            "path": "",
                            "globals": "--kubeconfig=${p:Get Environment Properties\/kubeconfig}",
                            "contextname": "${p:kube.context}"
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Use Context",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": true,
                        "impersonationUseSudo": false,
                        "pluginVersion": 15,
                        "commandName": "Helm Init",
                        "pluginName": "Kubernetes",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "cluster": "",
                            "flags": "--client-only",
                            "path": "",
                            "kubeconfig": "${p:Get Environment Properties\/kubeconfig}"
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Helm Init",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "pluginVersion": 9,
                        "commandName": "Shell",
                        "pluginName": "Shell",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "directoryOffset": ".",
                            "shellInterpreter": "",
                            "scriptBody": "echo \"1\" | bx pr login -u admin -p admin --skip-ssl-validation",
                            "runAsDaemon": "false",
                            "outputFile": ""
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "ICP Login",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "postProcessingScript": {
                            "id": "164856a1-dcae-1843-7736-a0c78da2c99f",
                            "name": "Helm_Upgrade_Post_Check",
                            "description": "",
                            "body": "var exit = properties.get('exitCode');\r\n\r\ncommandOut.println(\"initial step exitCode = \" + exit);\r\n\r\nvar passed = 0;\r\ncommandOut.println(\"initial passed = \" + passed);\r\n\r\nscanner.register(\"STATUS: DEPLOYED\", function(lineNumber, line) {\r\n      var value = line.replace(\"STATUS: \", \"\");\r\n      properties.put(\"Value\", value);\r\n      passed = 1;\r\n  });\r\n  \r\nscanner.scan();\r\n\r\nvar currentValue = properties.get('Value');\r\ncommandOut.println(\"STATUS = \" + currentValue);\r\ncommandOut.println(\"Determined passed = \" + passed);\r\n\r\nif (passed == 1) {\r\n    commandOut.println(\"passed is 1. found keyword. Override Failure and set status to Success !!!\");\r\n    properties.put('Status', 'Success');\r\n} else {\r\n    commandOut.println(\"passed is not 1 -> keyword not found. Failure.\");\r\n    properties.put('Status', 'Failure');\r\n}\r\n\r\ncommandOut.println(\"Final step status = \" + properties.get('Status'));\r\n"
                        },
                        "pluginVersion": 9,
                        "commandName": "Shell",
                        "pluginName": "Shell",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "directoryOffset": ".",
                            "shellInterpreter": "",
                            "scriptBody": "echo \"Environment Name = ${p:environment.name}\"\necho \"Component Name = ${p:component.name}\"\necho \"Current selected Component Version Name = ${p:version.name}\"\n\nrc=`cut -d. -f1 <<< ${p:version.name} 2>&1`\necho \"temporary rc = $rc\"\nrc=`echo \"${rc}\" | sed -r 's\/[\/]+\/-\/g' 2>&1`\necho \"Git Branch = $rc\"\nhr=\"${p:component.name}-${p:environment.name}-${rc}\"\necho \"Old Helm release = ${p:helm.release}-${rc}\"\necho \"New Helm release = ${hr}\"\necho \"Ensure helm release name only contains lower case.\"\necho \"Helm release (all lower case) = ${hr}\"\nhr=`echo \"${hr}\" | tr '[:upper:]' '[:lower:]' 2>&1`\necho \"Ensure helm release name has < 53 characters, and cut off after 53th character.\"\nhr=`cut -c-53 <<< ${hr} 2>&1`\necho \"Final Helm release = ${hr}\"\nhelm upgrade ${hr} .\/helm_chart --namespace ${p:icp.namespace} --install --wait --timeout 30 --tls --debug",
                            "runAsDaemon": "false",
                            "outputFile": ""
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Helm Custom Upgrade",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "postProcessingScript": {
                            "id": "1648aa12-1407-a32e-2332-03942a18d352",
                            "name": "Post Check Status Before",
                            "description": "",
                            "body": "properties.put('Status', 'Success');\n\nvar exit = properties.get('exitCode');\ncommandOut.println(\"initial step exitCode = \" + exit);\n\nvar passed = 0;\ncommandOut.println(\"initial passed = \" + passed);\n\nscanner.register(\"Counter: \", function(lineNumber, line) {\n      var value = line.replace(\"Counter: \", \"\");\n      properties.put('Counter', value);\n      passed = 1;\n  });\n  \nscanner.scan();\n\nvar currentValue = properties.get('Counter');\n\ncommandOut.println(\"Counter = \" + currentValue);\ncommandOut.println(\"Determined passed = \" + passed);\n\ncommandOut.println(\"Final step status = \" + properties.get('Status'));\n"
                        },
                        "pluginVersion": 9,
                        "commandName": "Shell",
                        "pluginName": "Shell",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "directoryOffset": ".",
                            "shellInterpreter": "",
                            "scriptBody": "echo \"Check release status: namespace = ${p:icp.namespace} ,  release name = ${p:helm.release}\"\n\nhelm ls --deployed --namespace ${p:icp.namespace} --tls | awk '\/${p:helm.release}\/ {print \"Counter: \" $2}'",
                            "runAsDaemon": "false",
                            "outputFile": ""
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Check status before",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "pluginVersion": 74,
                        "commandName": "Get Component Version For Resource",
                        "pluginName": "IBM UrbanCode Deploy Resources",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "component": "${p:component.id}",
                            "resource": "${p:resource.id}"
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Get Component Version",
                        "children": []
                    }
                ]
            }
        },
        {
            "name": "Deploy Helm Chart - backup v1.0",
            "description": "",
            "defaultWorkingDir": "${p:resource\/work.dir}\/${p:component.name}",
            "takesVersion": true,
            "inventoryActionType": "ADD",
            "status": "Active",
            "configActionType": "ADD",
            "active": true,
            "path": "componentTemplates\/164802f5-2d4c-031f-94d2-112d48a7d34c\/processes\/1648ac9a-e480-3dde-9bfd-e2730a73dbab",
            "deleted": false,
            "propDefs": [],
            "rootActivity": {
                "edges": [
                    {
                        "to": "Use Context",
                        "from": "Get Environment Properties",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Shell",
                        "from": "Use Context",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Replace Tokens",
                        "from": "Download Artifacts",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Clean Working Directory",
                        "type": "ALWAYS",
                        "value": ""
                    },
                    {
                        "to": "Download Artifacts",
                        "from": "Clean Working Directory",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "d9f33966df5b6f03e8f84fef79bf0a",
                        "from": "Helm Upgrade",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Get Environment Properties",
                        "from": "Replace Tokens",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Helm Init",
                        "from": "Shell",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Helm Upgrade",
                        "from": "Helm Init",
                        "type": "SUCCESS",
                        "value": ""
                    }
                ],
                "offsets": [
                    {
                        "name": "Replace Tokens",
                        "x": -69.99999999999994,
                        "y": 420,
                        "h": 80,
                        "w": 280
                    },
                    {
                        "name": "Clean Working Directory",
                        "x": -90,
                        "y": 140,
                        "h": 80,
                        "w": 380
                    },
                    {
                        "name": "Get Environment Properties",
                        "x": -109.99999999999994,
                        "y": 580,
                        "h": 80,
                        "w": 380
                    },
                    {
                        "name": "Use Context",
                        "x": -40.000000000000114,
                        "y": 730,
                        "h": 80,
                        "w": 250
                    },
                    {
                        "name": "Helm Init",
                        "x": -30.00000000000017,
                        "y": 1080,
                        "h": 80,
                        "w": 230
                    },
                    {
                        "name": "d9f33966df5b6f03e8f84fef79bf0a",
                        "x": 26.87355967741948,
                        "y": 1410,
                        "h": 90,
                        "w": 130
                    },
                    {
                        "name": "Download Artifacts",
                        "x": -59.999999999999886,
                        "y": 280,
                        "h": 80,
                        "w": 300
                    },
                    {
                        "name": "Shell",
                        "x": -9.999999999999886,
                        "y": 887.154761904762,
                        "h": 80,
                        "w": 180
                    },
                    {
                        "name": "Helm Upgrade",
                        "x": -50.00000000000015,
                        "y": 1250,
                        "h": 80,
                        "w": 270
                    }
                ],
                "layoutMode": "manual",
                "type": "graph",
                "name": "5adec20d-a3c2-4e62-816a-fda2cecbd3c8",
                "children": [
                    {
                        "type": "finish",
                        "name": "d9f33966df5b6f03e8f84fef79bf0a",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "pluginVersion": 65,
                        "commandName": "Delete Files and Directories",
                        "pluginName": "File Utils",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "baseDir": ".",
                            "includes": "**\/*\r\n*",
                            "excludes": "",
                            "followSymlinks": "false",
                            "caseSensitive": "true"
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Clean Working Directory",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "pluginVersion": 30,
                        "commandName": "Download Artifacts",
                        "pluginName": "UrbanCode Deploy Versioned File Storage",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "directoryOffset": "\/helm_chart",
                            "artifactSetBaseDir": "",
                            "fileIncludePatterns": "**\/*",
                            "fileExcludePatterns": "",
                            "syncMode": "true",
                            "fullVerification": "true",
                            "setFileExecuteBits": "false",
                            "verifyFileIntegrity": "false",
                            "versionId": "${p:version.id}",
                            "serverUrl": "${p:server.url}",
                            "compId": "${p:component.id}",
                            "resId": "${p:resource.id}",
                            "charset": "",
                            "label": ""
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Download Artifacts",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "pluginVersion": 65,
                        "commandName": "Replace Tokens",
                        "pluginName": "File Utils",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "includes": "**\/*",
                            "excludes": "",
                            "envPropValues": "${p:environment\/allProperties},${p:component\/allProperties},${p:resource\/allProperties},${p:environment\/allProperties}",
                            "propertyPrefix": "",
                            "explicitTokens": "",
                            "startDelimiter": "@@@",
                            "endDelimiter": "@@@",
                            "propFile": "replace_tokens.properties",
                            "dir": "",
                            "customEncoding": ""
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Replace Tokens",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "pluginVersion": 78,
                        "commandName": "Get Environment Properties",
                        "pluginName": "UrbanCode Deploy Environments",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "application": "${p:application.name}",
                            "environment": "${p:environment.name}"
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Get Environment Properties",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": true,
                        "impersonationUseSudo": false,
                        "pluginVersion": 15,
                        "commandName": "Use Context",
                        "pluginName": "Kubernetes",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "url": "",
                            "username": "",
                            "password": "crypt_v1{AES\/CBC\/PKCS5Padding|aes128keyabk8|\/mEVs7YQ1NzLga9cNjvPuQ==|4Pu7a4EkUV1eXqZwWOh43g==}",
                            "namespace": "",
                            "path": "",
                            "globals": "--kubeconfig=${p:Get Environment Properties\/kubeconfig}",
                            "contextname": "${p:kube.context}"
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Use Context",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": true,
                        "impersonationUseSudo": false,
                        "pluginVersion": 15,
                        "commandName": "Helm Init",
                        "pluginName": "Kubernetes",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "cluster": "",
                            "flags": "--client-only",
                            "path": "",
                            "kubeconfig": "${p:Get Environment Properties\/kubeconfig}"
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Helm Init",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": true,
                        "impersonationUseSudo": false,
                        "pluginVersion": 15,
                        "commandName": "Helm Upgrade",
                        "pluginName": "Kubernetes",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "release": "${p:helm.release}",
                            "chart": ".\/helm_chart",
                            "flags": "--namespace\r\n${p:icp.namespace}\r\n--install\r\n--wait\r\n--timeout\r\n30\r\n--tls\r\n--debug",
                            "path": "",
                            "kubeconfig": "${p:Get Environment Properties\/kubeconfig}"
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Helm Upgrade",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "pluginVersion": 9,
                        "commandName": "Shell",
                        "pluginName": "Shell",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "directoryOffset": ".",
                            "shellInterpreter": "",
                            "scriptBody": "echo \"1\" | bx pr login -u admin -p admin --skip-ssl-validation",
                            "runAsDaemon": "false",
                            "outputFile": ""
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Shell",
                        "children": []
                    }
                ]
            }
        },
        {
            "name": "Deploy Helm Chart - backup v2",
            "description": "",
            "defaultWorkingDir": "${p:resource\/work.dir}\/${p:component.name}",
            "takesVersion": true,
            "inventoryActionType": "ADD",
            "status": "Active",
            "configActionType": "ADD",
            "active": true,
            "path": "componentTemplates\/164802f5-2d4c-031f-94d2-112d48a7d34c\/processes\/164a552d-b8a1-6478-164c-34d553364751",
            "deleted": false,
            "propDefs": [],
            "rootActivity": {
                "edges": [
                    {
                        "to": "Replace Tokens",
                        "from": "Download Artifacts",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "d9f33966df5b6f03e8f84fef79bf0a",
                        "from": "Helm Custom Upgrade",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Get Environment Properties",
                        "from": "Replace Tokens",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "First Error Handling",
                        "from": "Helm Upgrade",
                        "type": "FAILURE",
                        "value": ""
                    },
                    {
                        "to": "d9f33966df5b6f03e8f84fef79bf0a",
                        "from": "Helm Upgrade",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Download Artifacts",
                        "from": "Clean Working Directory",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Helm Upgrade",
                        "from": "Check status before",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Check status before",
                        "from": "Helm Init",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Helm Init",
                        "from": "ICP Login",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "ICP Login",
                        "from": "Use Context",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Helm Custom Upgrade",
                        "from": "First Error Handling",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Clean Working Directory",
                        "type": "ALWAYS",
                        "value": ""
                    },
                    {
                        "to": "Use Context",
                        "from": "Get Environment Properties",
                        "type": "SUCCESS",
                        "value": ""
                    }
                ],
                "offsets": [
                    {
                        "name": "Clean Working Directory",
                        "x": -90,
                        "y": 140,
                        "h": 80,
                        "w": 380
                    },
                    {
                        "name": "Helm Upgrade",
                        "x": 455.0000000000001,
                        "y": 830,
                        "h": 80,
                        "w": 270
                    },
                    {
                        "name": "ICP Login",
                        "x": 205.00000000000006,
                        "y": 650,
                        "h": 80,
                        "w": 180
                    },
                    {
                        "name": "Use Context",
                        "x": -119.99999999999989,
                        "y": 670,
                        "h": 80,
                        "w": 250
                    },
                    {
                        "name": "Check status before",
                        "x": 60.000000000000114,
                        "y": 830,
                        "h": 80,
                        "w": 260
                    },
                    {
                        "name": "Helm Custom Upgrade",
                        "x": 320.0000000000001,
                        "y": 1150,
                        "h": 80,
                        "w": 280
                    },
                    {
                        "name": "d9f33966df5b6f03e8f84fef79bf0a",
                        "x": 755.0000000000001,
                        "y": 1160,
                        "h": 90,
                        "w": 130
                    },
                    {
                        "name": "Helm Init",
                        "x": -289.9999999999999,
                        "y": 830,
                        "h": 80,
                        "w": 230
                    },
                    {
                        "name": "Replace Tokens",
                        "x": -69.99999999999994,
                        "y": 420,
                        "h": 80,
                        "w": 280
                    },
                    {
                        "name": "Download Artifacts",
                        "x": -59.999999999999886,
                        "y": 280,
                        "h": 80,
                        "w": 300
                    },
                    {
                        "name": "First Error Handling",
                        "x": 330.0000000000001,
                        "y": 980,
                        "h": 80,
                        "w": 250
                    },
                    {
                        "name": "Get Environment Properties",
                        "x": -119.99999999999989,
                        "y": 540,
                        "h": 80,
                        "w": 380
                    }
                ],
                "layoutMode": "manual",
                "type": "graph",
                "name": "4b84de17-03cf-4f7f-9972-d4404a75d464",
                "children": [
                    {
                        "type": "finish",
                        "name": "d9f33966df5b6f03e8f84fef79bf0a",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "pluginVersion": 65,
                        "commandName": "Delete Files and Directories",
                        "pluginName": "File Utils",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "baseDir": ".",
                            "includes": "**\/*\r\n*",
                            "excludes": "",
                            "followSymlinks": "false",
                            "caseSensitive": "true"
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Clean Working Directory",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "pluginVersion": 30,
                        "commandName": "Download Artifacts",
                        "pluginName": "UrbanCode Deploy Versioned File Storage",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "directoryOffset": "\/helm_chart",
                            "artifactSetBaseDir": "",
                            "fileIncludePatterns": "**\/*",
                            "fileExcludePatterns": "",
                            "syncMode": "true",
                            "fullVerification": "true",
                            "setFileExecuteBits": "false",
                            "verifyFileIntegrity": "false",
                            "versionId": "${p:version.id}",
                            "serverUrl": "${p:server.url}",
                            "compId": "${p:component.id}",
                            "resId": "${p:resource.id}",
                            "charset": "",
                            "label": ""
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Download Artifacts",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "pluginVersion": 65,
                        "commandName": "Replace Tokens",
                        "pluginName": "File Utils",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "includes": "**\/*",
                            "excludes": "",
                            "envPropValues": "${p:environment\/allProperties},${p:component\/allProperties},${p:resource\/allProperties},${p:environment\/allProperties}",
                            "propertyPrefix": "",
                            "explicitTokens": "",
                            "startDelimiter": "@@@",
                            "endDelimiter": "@@@",
                            "propFile": "replace_tokens.properties",
                            "dir": "",
                            "customEncoding": ""
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Replace Tokens",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "pluginVersion": 78,
                        "commandName": "Get Environment Properties",
                        "pluginName": "UrbanCode Deploy Environments",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "application": "${p:application.name}",
                            "environment": "${p:environment.name}"
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Get Environment Properties",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": true,
                        "impersonationUseSudo": false,
                        "pluginVersion": 15,
                        "commandName": "Use Context",
                        "pluginName": "Kubernetes",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "url": "",
                            "username": "",
                            "password": "crypt_v1{AES\/CBC\/PKCS5Padding|aes128keyabk8|NxWAW5jRMjubuZS8W\/jQuQ==|4E8ztTqbK4aN0XGbaBtimw==}",
                            "namespace": "",
                            "path": "",
                            "globals": "--kubeconfig=${p:Get Environment Properties\/kubeconfig}",
                            "contextname": "${p:kube.context}"
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Use Context",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": true,
                        "impersonationUseSudo": false,
                        "pluginVersion": 15,
                        "commandName": "Helm Init",
                        "pluginName": "Kubernetes",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "cluster": "",
                            "flags": "--client-only",
                            "path": "",
                            "kubeconfig": "${p:Get Environment Properties\/kubeconfig}"
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Helm Init",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": true,
                        "impersonationUseSudo": false,
                        "pluginVersion": 15,
                        "commandName": "Helm Upgrade",
                        "pluginName": "Kubernetes",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "release": "${p:helm.release}",
                            "chart": ".\/helm_chart",
                            "flags": "--namespace\r\n${p:icp.namespace}\r\n--install\r\n--wait\r\n--timeout\r\n30\r\n--tls\r\n--debug",
                            "path": "",
                            "kubeconfig": "${p:Get Environment Properties\/kubeconfig}"
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Helm Upgrade",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "pluginVersion": 9,
                        "commandName": "Shell",
                        "pluginName": "Shell",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "directoryOffset": ".",
                            "shellInterpreter": "",
                            "scriptBody": "echo \"1\" | bx pr login -u admin -p admin --skip-ssl-validation",
                            "runAsDaemon": "false",
                            "outputFile": ""
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "ICP Login",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "postProcessingScript": {
                            "id": "164856a1-dcae-1843-7736-a0c78da2c99f",
                            "name": "Helm_Upgrade_Post_Check",
                            "description": "",
                            "body": "var exit = properties.get('exitCode');\r\n\r\ncommandOut.println(\"initial step exitCode = \" + exit);\r\n\r\nvar passed = 0;\r\ncommandOut.println(\"initial passed = \" + passed);\r\n\r\nscanner.register(\"STATUS: DEPLOYED\", function(lineNumber, line) {\r\n      var value = line.replace(\"STATUS: \", \"\");\r\n      properties.put(\"Value\", value);\r\n      passed = 1;\r\n  });\r\n  \r\nscanner.scan();\r\n\r\nvar currentValue = properties.get('Value');\r\ncommandOut.println(\"STATUS = \" + currentValue);\r\ncommandOut.println(\"Determined passed = \" + passed);\r\n\r\nif (passed == 1) {\r\n    commandOut.println(\"passed is 1. found keyword. Override Failure and set status to Success !!!\");\r\n    properties.put('Status', 'Success');\r\n} else {\r\n    commandOut.println(\"passed is not 1 -> keyword not found. Failure.\");\r\n    properties.put('Status', 'Failure');\r\n}\r\n\r\ncommandOut.println(\"Final step status = \" + properties.get('Status'));\r\n"
                        },
                        "pluginVersion": 9,
                        "commandName": "Shell",
                        "pluginName": "Shell",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "directoryOffset": ".",
                            "shellInterpreter": "",
                            "scriptBody": "helm upgrade ${p:helm.release} .\/helm_chart --namespace ${p:icp.namespace} --install --wait --timeout 30 --tls --debug",
                            "runAsDaemon": "false",
                            "outputFile": ""
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Helm Custom Upgrade",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "pluginVersion": 9,
                        "commandName": "Shell",
                        "pluginName": "Shell",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "directoryOffset": ".",
                            "shellInterpreter": "",
                            "scriptBody": "echo \"Error handling: namespace = ${p:icp.namespace} ,  release name = ${p:helm.release}\"\n\nhelm ls --deployed --namespace ${p:icp.namespace} --tls | awk '\/${p:helm.release}\/ {print \"Counter: \" $2}'",
                            "runAsDaemon": "false",
                            "outputFile": ""
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "First Error Handling",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "postProcessingScript": {
                            "id": "1648aa12-1407-a32e-2332-03942a18d352",
                            "name": "Post Check Status Before",
                            "description": "",
                            "body": "properties.put('Status', 'Success');\n\nvar exit = properties.get('exitCode');\ncommandOut.println(\"initial step exitCode = \" + exit);\n\nvar passed = 0;\ncommandOut.println(\"initial passed = \" + passed);\n\nscanner.register(\"Counter: \", function(lineNumber, line) {\n      var value = line.replace(\"Counter: \", \"\");\n      properties.put('Counter', value);\n      passed = 1;\n  });\n  \nscanner.scan();\n\nvar currentValue = properties.get('Counter');\n\ncommandOut.println(\"Counter = \" + currentValue);\ncommandOut.println(\"Determined passed = \" + passed);\n\ncommandOut.println(\"Final step status = \" + properties.get('Status'));\n"
                        },
                        "pluginVersion": 9,
                        "commandName": "Shell",
                        "pluginName": "Shell",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "directoryOffset": ".",
                            "shellInterpreter": "",
                            "scriptBody": "echo \"Check release status: namespace = ${p:icp.namespace} ,  release name = ${p:helm.release}\"\n\nhelm ls --deployed --namespace ${p:icp.namespace} --tls | awk '\/${p:helm.release}\/ {print \"Counter: \" $2}'",
                            "runAsDaemon": "false",
                            "outputFile": ""
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Check status before",
                        "children": []
                    }
                ]
            }
        },
        {
            "name": "Deploy Test",
            "description": "continue working version",
            "defaultWorkingDir": "${p:resource\/work.dir}\/${p:component.name}",
            "takesVersion": true,
            "inventoryActionType": "ADD",
            "status": "Active",
            "configActionType": "ADD",
            "active": true,
            "path": "componentTemplates\/164802f5-2d4c-031f-94d2-112d48a7d34c\/processes\/1648a08d-0dbb-1749-62f4-1ff72453db92",
            "deleted": false,
            "propDefs": [],
            "rootActivity": {
                "edges": [
                    {
                        "to": "Use Context",
                        "from": "Get Environment Properties",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Helm Custom Upgrade",
                        "from": "Get Component Version",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "d9f33966df5b6f03e8f84fef79bf0a",
                        "from": "Helm Custom Upgrade",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "ICP Login",
                        "from": "Use Context",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Download Artifacts",
                        "from": "Clean Working Directory",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Get Component Version",
                        "from": "Check status before",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Get Environment Properties",
                        "from": "Replace Tokens",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Clean Working Directory",
                        "type": "ALWAYS",
                        "value": ""
                    },
                    {
                        "to": "Helm Init",
                        "from": "ICP Login",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Replace Tokens",
                        "from": "Download Artifacts",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Check status before",
                        "from": "Helm Init",
                        "type": "SUCCESS",
                        "value": ""
                    }
                ],
                "offsets": [
                    {
                        "name": "Replace Tokens",
                        "x": -69.99999999999994,
                        "y": 420,
                        "h": 80,
                        "w": 280
                    },
                    {
                        "name": "Clean Working Directory",
                        "x": -90,
                        "y": 140,
                        "h": 80,
                        "w": 380
                    },
                    {
                        "name": "ICP Login",
                        "x": 205.00000000000006,
                        "y": 650,
                        "h": 80,
                        "w": 180
                    },
                    {
                        "name": "Download Artifacts",
                        "x": -59.999999999999886,
                        "y": 280,
                        "h": 80,
                        "w": 300
                    },
                    {
                        "name": "d9f33966df5b6f03e8f84fef79bf0a",
                        "x": 755.0000000000001,
                        "y": 1160,
                        "h": 90,
                        "w": 130
                    },
                    {
                        "name": "Helm Custom Upgrade",
                        "x": 15.000000000000114,
                        "y": 1170,
                        "h": 80,
                        "w": 280
                    },
                    {
                        "name": "Use Context",
                        "x": -119.99999999999989,
                        "y": 670,
                        "h": 80,
                        "w": 250
                    },
                    {
                        "name": "Helm Init",
                        "x": -289.9999999999999,
                        "y": 830,
                        "h": 80,
                        "w": 230
                    },
                    {
                        "name": "Get Component Version",
                        "x": -25,
                        "y": 990,
                        "h": 80,
                        "w": 460
                    },
                    {
                        "name": "Get Environment Properties",
                        "x": -119.99999999999989,
                        "y": 540,
                        "h": 80,
                        "w": 380
                    },
                    {
                        "name": "Check status before",
                        "x": 60.000000000000114,
                        "y": 830,
                        "h": 80,
                        "w": 260
                    }
                ],
                "layoutMode": "manual",
                "type": "graph",
                "name": "68fb2f2f-1afd-4d70-a3e0-f65d463327ab",
                "children": [
                    {
                        "type": "finish",
                        "name": "d9f33966df5b6f03e8f84fef79bf0a",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "pluginVersion": 65,
                        "commandName": "Delete Files and Directories",
                        "pluginName": "File Utils",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "baseDir": ".",
                            "includes": "**\/*\r\n*",
                            "excludes": "",
                            "followSymlinks": "false",
                            "caseSensitive": "true"
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Clean Working Directory",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "pluginVersion": 30,
                        "commandName": "Download Artifacts",
                        "pluginName": "UrbanCode Deploy Versioned File Storage",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "directoryOffset": "\/helm_chart",
                            "artifactSetBaseDir": "",
                            "fileIncludePatterns": "**\/*",
                            "fileExcludePatterns": "",
                            "syncMode": "true",
                            "fullVerification": "true",
                            "setFileExecuteBits": "false",
                            "verifyFileIntegrity": "false",
                            "versionId": "${p:version.id}",
                            "serverUrl": "${p:server.url}",
                            "compId": "${p:component.id}",
                            "resId": "${p:resource.id}",
                            "charset": "",
                            "label": ""
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Download Artifacts",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "pluginVersion": 65,
                        "commandName": "Replace Tokens",
                        "pluginName": "File Utils",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "includes": "**\/*",
                            "excludes": "",
                            "envPropValues": "${p:environment\/allProperties},${p:component\/allProperties},${p:resource\/allProperties},${p:environment\/allProperties}",
                            "propertyPrefix": "",
                            "explicitTokens": "",
                            "startDelimiter": "@@@",
                            "endDelimiter": "@@@",
                            "propFile": "replace_tokens.properties",
                            "dir": "",
                            "customEncoding": ""
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Replace Tokens",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "pluginVersion": 78,
                        "commandName": "Get Environment Properties",
                        "pluginName": "UrbanCode Deploy Environments",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "application": "${p:application.name}",
                            "environment": "${p:environment.name}"
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Get Environment Properties",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": true,
                        "impersonationUseSudo": false,
                        "pluginVersion": 15,
                        "commandName": "Use Context",
                        "pluginName": "Kubernetes",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "url": "",
                            "username": "",
                            "password": "crypt_v1{AES\/CBC\/PKCS5Padding|aes128keyabk8|+UjOs4o4VRwuiNCTkbQFwA==|lv+yQrzDOihwCKYL4sMaJA==}",
                            "namespace": "",
                            "path": "",
                            "globals": "--kubeconfig=${p:Get Environment Properties\/kubeconfig}",
                            "contextname": "${p:kube.context}"
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Use Context",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": true,
                        "impersonationUseSudo": false,
                        "pluginVersion": 15,
                        "commandName": "Helm Init",
                        "pluginName": "Kubernetes",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "cluster": "",
                            "flags": "--client-only",
                            "path": "",
                            "kubeconfig": "${p:Get Environment Properties\/kubeconfig}"
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Helm Init",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "pluginVersion": 9,
                        "commandName": "Shell",
                        "pluginName": "Shell",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "directoryOffset": ".",
                            "shellInterpreter": "",
                            "scriptBody": "echo \"1\" | bx pr login -u admin -p admin --skip-ssl-validation",
                            "runAsDaemon": "false",
                            "outputFile": ""
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "ICP Login",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "postProcessingScript": {
                            "id": "164856a1-dcae-1843-7736-a0c78da2c99f",
                            "name": "Helm_Upgrade_Post_Check",
                            "description": "",
                            "body": "var exit = properties.get('exitCode');\r\n\r\ncommandOut.println(\"initial step exitCode = \" + exit);\r\n\r\nvar passed = 0;\r\ncommandOut.println(\"initial passed = \" + passed);\r\n\r\nscanner.register(\"STATUS: DEPLOYED\", function(lineNumber, line) {\r\n      var value = line.replace(\"STATUS: \", \"\");\r\n      properties.put(\"Value\", value);\r\n      passed = 1;\r\n  });\r\n  \r\nscanner.scan();\r\n\r\nvar currentValue = properties.get('Value');\r\ncommandOut.println(\"STATUS = \" + currentValue);\r\ncommandOut.println(\"Determined passed = \" + passed);\r\n\r\nif (passed == 1) {\r\n    commandOut.println(\"passed is 1. found keyword. Override Failure and set status to Success !!!\");\r\n    properties.put('Status', 'Success');\r\n} else {\r\n    commandOut.println(\"passed is not 1 -> keyword not found. Failure.\");\r\n    properties.put('Status', 'Failure');\r\n}\r\n\r\ncommandOut.println(\"Final step status = \" + properties.get('Status'));\r\n"
                        },
                        "pluginVersion": 9,
                        "commandName": "Shell",
                        "pluginName": "Shell",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "directoryOffset": ".",
                            "shellInterpreter": "",
                            "scriptBody": "echo \"Environment Name = ${p:environment.name}\"\necho \"Component Name = ${p:component.name}\"\necho \"Component Version Name = ${p:Get Component Version\/version.name}\"\nrc=`cut -d. -f1 <<< ${p:Get Component Version\/version.name} 2>&1`\necho \"temporary rc = $rc\"\nrc=`echo \"${rc}\" | sed -r 's\/[\/]+\/-\/g' 2>&1`\necho \"Git Branch = $rc\"\nhr=\"${p:component.name}-${p:environment.name}-${rc}\"\necho \"Old Helm release = ${p:helm.release}-${rc}\"\necho \"New Helm release = ${hr}\"\necho \"Ensure helm release name complies with naming rules.\"\nhr=`echo \"${hr}\" | tr '[:upper:]' '[:lower:]' 2>&1`\necho \"Final Helm release = ${hr}\"\nhelm upgrade ${hr} .\/helm_chart --namespace ${p:icp.namespace} --install --wait --timeout 30 --tls --debug",
                            "runAsDaemon": "false",
                            "outputFile": ""
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Helm Custom Upgrade",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "postProcessingScript": {
                            "id": "1648aa12-1407-a32e-2332-03942a18d352",
                            "name": "Post Check Status Before",
                            "description": "",
                            "body": "properties.put('Status', 'Success');\n\nvar exit = properties.get('exitCode');\ncommandOut.println(\"initial step exitCode = \" + exit);\n\nvar passed = 0;\ncommandOut.println(\"initial passed = \" + passed);\n\nscanner.register(\"Counter: \", function(lineNumber, line) {\n      var value = line.replace(\"Counter: \", \"\");\n      properties.put('Counter', value);\n      passed = 1;\n  });\n  \nscanner.scan();\n\nvar currentValue = properties.get('Counter');\n\ncommandOut.println(\"Counter = \" + currentValue);\ncommandOut.println(\"Determined passed = \" + passed);\n\ncommandOut.println(\"Final step status = \" + properties.get('Status'));\n"
                        },
                        "pluginVersion": 9,
                        "commandName": "Shell",
                        "pluginName": "Shell",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "directoryOffset": ".",
                            "shellInterpreter": "",
                            "scriptBody": "echo \"Check release status: namespace = ${p:icp.namespace} ,  release name = ${p:helm.release}\"\n\nhelm ls --deployed --namespace ${p:icp.namespace} --tls | awk '\/${p:helm.release}\/ {print \"Counter: \" $2}'",
                            "runAsDaemon": "false",
                            "outputFile": ""
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Check status before",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "pluginVersion": 74,
                        "commandName": "Get Component Version For Resource",
                        "pluginName": "IBM UrbanCode Deploy Resources",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "component": "${p:component.id}",
                            "resource": "${p:resource.id}"
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Get Component Version",
                        "children": []
                    }
                ]
            }
        },
        {
            "name": "Deploy Test (copy)",
            "description": "continue working version",
            "defaultWorkingDir": "${p:resource\/work.dir}\/${p:component.name}",
            "takesVersion": true,
            "inventoryActionType": "ADD",
            "status": "Active",
            "configActionType": "ADD",
            "active": true,
            "path": "componentTemplates\/164802f5-2d4c-031f-94d2-112d48a7d34c\/processes\/164a4d05-ecc2-e2fc-3fa7-ed20a649f30e",
            "deleted": false,
            "propDefs": [],
            "rootActivity": {
                "edges": [
                    {
                        "to": "Replace Tokens",
                        "from": "Download Artifacts",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "d9f33966df5b6f03e8f84fef79bf0a",
                        "from": "Helm Custom Upgrade",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Get Environment Properties",
                        "from": "Replace Tokens",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "First Error Handling",
                        "from": "Helm Upgrade",
                        "type": "FAILURE",
                        "value": ""
                    },
                    {
                        "to": "d9f33966df5b6f03e8f84fef79bf0a",
                        "from": "Helm Upgrade",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Download Artifacts",
                        "from": "Clean Working Directory",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Helm Upgrade",
                        "from": "Check status before",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Check status before",
                        "from": "Helm Init",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Helm Init",
                        "from": "ICP Login",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "ICP Login",
                        "from": "Use Context",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Helm Custom Upgrade",
                        "from": "First Error Handling",
                        "type": "SUCCESS",
                        "value": ""
                    },
                    {
                        "to": "Clean Working Directory",
                        "type": "ALWAYS",
                        "value": ""
                    },
                    {
                        "to": "Use Context",
                        "from": "Get Environment Properties",
                        "type": "SUCCESS",
                        "value": ""
                    }
                ],
                "offsets": [
                    {
                        "name": "Clean Working Directory",
                        "x": -90,
                        "y": 140,
                        "h": 80,
                        "w": 380
                    },
                    {
                        "name": "Helm Upgrade",
                        "x": 455.0000000000001,
                        "y": 830,
                        "h": 80,
                        "w": 270
                    },
                    {
                        "name": "ICP Login",
                        "x": 205.00000000000006,
                        "y": 650,
                        "h": 80,
                        "w": 180
                    },
                    {
                        "name": "Use Context",
                        "x": -119.99999999999989,
                        "y": 670,
                        "h": 80,
                        "w": 250
                    },
                    {
                        "name": "Check status before",
                        "x": 60.000000000000114,
                        "y": 830,
                        "h": 80,
                        "w": 260
                    },
                    {
                        "name": "Helm Custom Upgrade",
                        "x": 320.0000000000001,
                        "y": 1150,
                        "h": 80,
                        "w": 280
                    },
                    {
                        "name": "d9f33966df5b6f03e8f84fef79bf0a",
                        "x": 755.0000000000001,
                        "y": 1160,
                        "h": 90,
                        "w": 130
                    },
                    {
                        "name": "Helm Init",
                        "x": -289.9999999999999,
                        "y": 830,
                        "h": 80,
                        "w": 230
                    },
                    {
                        "name": "Replace Tokens",
                        "x": -69.99999999999994,
                        "y": 420,
                        "h": 80,
                        "w": 280
                    },
                    {
                        "name": "Download Artifacts",
                        "x": -59.999999999999886,
                        "y": 280,
                        "h": 80,
                        "w": 300
                    },
                    {
                        "name": "First Error Handling",
                        "x": 330.0000000000001,
                        "y": 980,
                        "h": 80,
                        "w": 250
                    },
                    {
                        "name": "Get Environment Properties",
                        "x": -119.99999999999989,
                        "y": 540,
                        "h": 80,
                        "w": 380
                    }
                ],
                "layoutMode": "manual",
                "type": "graph",
                "name": "4b84de17-03cf-4f7f-9972-d4404a75d464",
                "children": [
                    {
                        "type": "finish",
                        "name": "d9f33966df5b6f03e8f84fef79bf0a",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "pluginVersion": 65,
                        "commandName": "Delete Files and Directories",
                        "pluginName": "File Utils",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "baseDir": ".",
                            "includes": "**\/*\r\n*",
                            "excludes": "",
                            "followSymlinks": "false",
                            "caseSensitive": "true"
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Clean Working Directory",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "pluginVersion": 30,
                        "commandName": "Download Artifacts",
                        "pluginName": "UrbanCode Deploy Versioned File Storage",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "directoryOffset": "\/helm_chart",
                            "artifactSetBaseDir": "",
                            "fileIncludePatterns": "**\/*",
                            "fileExcludePatterns": "",
                            "syncMode": "true",
                            "fullVerification": "true",
                            "setFileExecuteBits": "false",
                            "verifyFileIntegrity": "false",
                            "versionId": "${p:version.id}",
                            "serverUrl": "${p:server.url}",
                            "compId": "${p:component.id}",
                            "resId": "${p:resource.id}",
                            "charset": "",
                            "label": ""
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Download Artifacts",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "pluginVersion": 65,
                        "commandName": "Replace Tokens",
                        "pluginName": "File Utils",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "includes": "**\/*",
                            "excludes": "",
                            "envPropValues": "${p:environment\/allProperties},${p:component\/allProperties},${p:resource\/allProperties},${p:environment\/allProperties}",
                            "propertyPrefix": "",
                            "explicitTokens": "",
                            "startDelimiter": "@@@",
                            "endDelimiter": "@@@",
                            "propFile": "replace_tokens.properties",
                            "dir": "",
                            "customEncoding": ""
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Replace Tokens",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "pluginVersion": 78,
                        "commandName": "Get Environment Properties",
                        "pluginName": "UrbanCode Deploy Environments",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "application": "${p:application.name}",
                            "environment": "${p:environment.name}"
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Get Environment Properties",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": true,
                        "impersonationUseSudo": false,
                        "pluginVersion": 15,
                        "commandName": "Use Context",
                        "pluginName": "Kubernetes",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "url": "",
                            "username": "",
                            "password": "crypt_v1{AES\/CBC\/PKCS5Padding|aes128keyabk8|89klwXwrFoIt2MXL2V0ljw==|aXAa3aYjWsGT0GXRaW28GQ==}",
                            "namespace": "",
                            "path": "",
                            "globals": "--kubeconfig=${p:Get Environment Properties\/kubeconfig}",
                            "contextname": "${p:kube.context}"
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Use Context",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": true,
                        "impersonationUseSudo": false,
                        "pluginVersion": 15,
                        "commandName": "Helm Init",
                        "pluginName": "Kubernetes",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "cluster": "",
                            "flags": "--client-only",
                            "path": "",
                            "kubeconfig": "${p:Get Environment Properties\/kubeconfig}"
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Helm Init",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": true,
                        "impersonationUseSudo": false,
                        "pluginVersion": 15,
                        "commandName": "Helm Upgrade",
                        "pluginName": "Kubernetes",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "release": "${p:helm.release}",
                            "chart": ".\/helm_chart",
                            "flags": "--namespace\r\n${p:icp.namespace}\r\n--install\r\n--wait\r\n--timeout\r\n30\r\n--tls\r\n--debug",
                            "path": "",
                            "kubeconfig": "${p:Get Environment Properties\/kubeconfig}"
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Helm Upgrade",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "pluginVersion": 9,
                        "commandName": "Shell",
                        "pluginName": "Shell",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "directoryOffset": ".",
                            "shellInterpreter": "",
                            "scriptBody": "echo \"1\" | bx pr login -u admin -p admin --skip-ssl-validation",
                            "runAsDaemon": "false",
                            "outputFile": ""
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "ICP Login",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "postProcessingScript": {
                            "id": "164856a1-dcae-1843-7736-a0c78da2c99f",
                            "name": "Helm_Upgrade_Post_Check",
                            "description": "",
                            "body": "var exit = properties.get('exitCode');\r\n\r\ncommandOut.println(\"initial step exitCode = \" + exit);\r\n\r\nvar passed = 0;\r\ncommandOut.println(\"initial passed = \" + passed);\r\n\r\nscanner.register(\"STATUS: DEPLOYED\", function(lineNumber, line) {\r\n      var value = line.replace(\"STATUS: \", \"\");\r\n      properties.put(\"Value\", value);\r\n      passed = 1;\r\n  });\r\n  \r\nscanner.scan();\r\n\r\nvar currentValue = properties.get('Value');\r\ncommandOut.println(\"STATUS = \" + currentValue);\r\ncommandOut.println(\"Determined passed = \" + passed);\r\n\r\nif (passed == 1) {\r\n    commandOut.println(\"passed is 1. found keyword. Override Failure and set status to Success !!!\");\r\n    properties.put('Status', 'Success');\r\n} else {\r\n    commandOut.println(\"passed is not 1 -> keyword not found. Failure.\");\r\n    properties.put('Status', 'Failure');\r\n}\r\n\r\ncommandOut.println(\"Final step status = \" + properties.get('Status'));\r\n"
                        },
                        "pluginVersion": 9,
                        "commandName": "Shell",
                        "pluginName": "Shell",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "directoryOffset": ".",
                            "shellInterpreter": "",
                            "scriptBody": "helm upgrade ${p:helm.release} .\/helm_chart --namespace ${p:icp.namespace} --install --wait --timeout 30 --tls --debug",
                            "runAsDaemon": "false",
                            "outputFile": ""
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Helm Custom Upgrade",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "pluginVersion": 9,
                        "commandName": "Shell",
                        "pluginName": "Shell",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "directoryOffset": ".",
                            "shellInterpreter": "",
                            "scriptBody": "echo \"Error handling: namespace = ${p:icp.namespace} ,  release name = ${p:helm.release}\"\n\nhelm ls --deployed --namespace ${p:icp.namespace} --tls | awk '\/${p:helm.release}\/ {print \"Counter: \" $2}'",
                            "runAsDaemon": "false",
                            "outputFile": ""
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "First Error Handling",
                        "children": []
                    },
                    {
                        "allowFailure": false,
                        "useImpersonation": false,
                        "showHidden": false,
                        "impersonationUseSudo": false,
                        "postProcessingScript": {
                            "id": "1648aa12-1407-a32e-2332-03942a18d352",
                            "name": "Post Check Status Before",
                            "description": "",
                            "body": "properties.put('Status', 'Success');\n\nvar exit = properties.get('exitCode');\ncommandOut.println(\"initial step exitCode = \" + exit);\n\nvar passed = 0;\ncommandOut.println(\"initial passed = \" + passed);\n\nscanner.register(\"Counter: \", function(lineNumber, line) {\n      var value = line.replace(\"Counter: \", \"\");\n      properties.put('Counter', value);\n      passed = 1;\n  });\n  \nscanner.scan();\n\nvar currentValue = properties.get('Counter');\n\ncommandOut.println(\"Counter = \" + currentValue);\ncommandOut.println(\"Determined passed = \" + passed);\n\ncommandOut.println(\"Final step status = \" + properties.get('Status'));\n"
                        },
                        "pluginVersion": 9,
                        "commandName": "Shell",
                        "pluginName": "Shell",
                        "authTokenRestriction": "20000001-0001-0001-0001-000000000000",
                        "properties": {
                            "directoryOffset": ".",
                            "shellInterpreter": "",
                            "scriptBody": "echo \"Check release status: namespace = ${p:icp.namespace} ,  release name = ${p:helm.release}\"\n\nhelm ls --deployed --namespace ${p:icp.namespace} --tls | awk '\/${p:helm.release}\/ {print \"Counter: \" $2}'",
                            "runAsDaemon": "false",
                            "outputFile": ""
                        },
                        "cachedAuthTokenRestriction": {
                            "name": "System Default",
                            "description": "Used by default for any plugin steps without a specified token restriction",
                            "restrictions": [{
                                "verb": "ALL",
                                "url": "\/*"
                            }]
                        },
                        "type": "plugin",
                        "name": "Check status before",
                        "children": []
                    }
                ]
            }
        }
    ],
    "genericProcesses": [],
    "teamMappings": []
}